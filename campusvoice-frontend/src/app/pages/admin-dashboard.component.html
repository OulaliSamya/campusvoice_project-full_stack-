<!-- src/app/pages/admin-dashboard.component.html -->
<div class="dashboard-header">
  <div>
    <h1>Dashboard</h1>
    <p class="subtitle">Vue d'ensemble de la plateforme CampusVoice</p>
  </div>
  <div class="header-actions">
    <button class="btn-refresh" (click)="loadData()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="23 4 23 10 17 10"></polyline>
        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
      </svg>
      Actualiser
    </button>
  </div>
</div>

<!-- Stats Cards -->
<div class="stats-grid">
  <div class="stat-card primary">
    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
    <div class="stat-content">
      <h3>{{ stats.totalFeedbacks }}</h3>
      <p>Total Feedbacks</p>
    </div>
    <div class="stat-trend positive">+12%</div>
  </div>

  <div class="stat-card success">
    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
      <circle cx="12" cy="7" r="4"></circle>
    </svg>
    <div class="stat-content">
      <h3>{{ stats.teachers }}</h3>
      <p>Enseignants</p>
    </div>
    <div class="stat-trend positive">+3</div>
  </div>

  <div class="stat-card warning">
    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
      <circle cx="9" cy="7" r="4"></circle>
      <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
      <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
    </svg>
    <div class="stat-content">
      <h3>{{ stats.students }}</h3>
      <p>Étudiants</p>
    </div>
    <div class="stat-trend positive">+25</div>
  </div>

  <div class="stat-card info">
    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
      <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
    </svg>
    <div class="stat-content">
      <h3>{{ stats.courses }}</h3>
      <p>Cours actifs</p>
    </div>
    <div class="stat-trend neutral">0</div>
  </div>
</div>

<!-- Graphiques Section -->
<div class="charts-section">
  <!-- Répartition des feedbacks -->
  <div class="chart-card">
    <div class="card-header">
      <h2>Répartition des feedbacks</h2>
      <span class="total-badge">Total: {{ totalFeedbacks }}</span>
    </div>
    <div class="feedback-chart">
      <div class="chart-row">
        <div class="chart-label">
          <span class="dot positive"></span>
          <span class="label-text">Positifs</span>
        </div>
        <div class="chart-bar-container">
          <div class="chart-bar positive" 
               [style.width.%]="calculatePercentage(categoryStats.positive)">
          </div>
        </div>
        <span class="chart-value">{{ categoryStats.positive }}</span>
        <span class="chart-percent">{{ calculatePercentage(categoryStats.positive) }}%</span>
      </div>

      <div class="chart-row">
        <div class="chart-label">
          <span class="dot neutral"></span>
          <span class="label-text">Neutres</span>
        </div>
        <div class="chart-bar-container">
          <div class="chart-bar neutral" 
               [style.width.%]="calculatePercentage(categoryStats.neutral)">
          </div>
        </div>
        <span class="chart-value">{{ categoryStats.neutral }}</span>
        <span class="chart-percent">{{ calculatePercentage(categoryStats.neutral) }}%</span>
      </div>

      <div class="chart-row">
        <div class="chart-label">
          <span class="dot negative"></span>
          <span class="label-text">Négatifs</span>
        </div>
        <div class="chart-bar-container">
          <div class="chart-bar negative" 
               [style.width.%]="calculatePercentage(categoryStats.negative)">
          </div>
        </div>
        <span class="chart-value">{{ categoryStats.negative }}</span>
        <span class="chart-percent">{{ calculatePercentage(categoryStats.negative) }}%</span>
      </div>
    </div>
  </div>

  <!-- Aperçu rapide des derniers feedbacks -->
  <div class="chart-card">
    <div class="card-header">
      <h2>Activité récente</h2>
      <a routerLink="/admin/feedbacks" class="view-all-link">Voir tout →</a>
    </div>
    <div class="recent-activity">
      <div *ngFor="let fb of latestFeedbacks.slice(0, 5)" class="activity-item">
        <svg class="activity-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        <div class="activity-content">
          <p class="activity-text">{{ fb.content | slice:0:60 }}...</p>
          <div class="activity-meta">
            <span class="meta-item">Cours: {{ fb.course?.title || 'N/A' }}</span>
            <span class="meta-item">Par: {{ fb.student?.fullName || 'Anonyme' }}</span>
            <span class="meta-item">{{ fb.createdAt | date:'short' }}</span>
          </div>
        </div>
      </div>
      <div *ngIf="latestFeedbacks.length === 0" class="empty-state">
        <p>Aucun feedback récent</p>
      </div>
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div class="quick-actions">
  <h2>Actions rapides</h2>
  <div class="actions-grid">
    <a routerLink="/admin/feedbacks" class="action-card">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      <span>Gérer les feedbacks</span>
    </a>
    <a routerLink="/admin/courses" class="action-card">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
      </svg>
      <span>Gérer les cours</span>
    </a>
    <a routerLink="/admin/users" class="action-card">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
      </svg>
      <span>Gérer les utilisateurs</span>
    </a>
    <a routerLink="/admin/settings" class="action-card">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M12 1v6m0 6v6"></path>
        <path d="M21 12h-6m-6 0H3"></path>
      </svg>
      <span>Paramètres</span>
    </a>
  </div>
</div>